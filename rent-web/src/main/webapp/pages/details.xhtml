<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
        >

<ui:composition template="/pages/template.xhtml">
    <ui:define name="menu">
        <ui:include src="/WEB-INF/frags/search.xhtml"/>
    </ui:define>

    <ui:define name="content">
        <h:form id="details">
            <p:growl id="growl" showDetail="true" sticky="true"/>

            <h2>Anunt -
                <h:outputText id="type" value="#{detailsMB.selected.adType}"/> -
                <h:outputText id="accomodation" value="#{detailsMB.selected.buildingType.name}"/>
                <p:rating value="#{detailsMB.favNr}" stars="1" cancel="false"
                          rendered="#{userMB.userLogged and (detailsMB.selected.status eq 'ACTIVE' or detailsMB.favNr eq 1)}">
                    <p:ajax event="rate" listener="#{detailsMB.makeFavorite()}" update="@this" />
                </p:rating>
            </h2>

            <p:outputPanel styleClass="ui-grid-row" style="margin-top: 10px" rendered="#{detailsMB.isMine()}">
                <p:outputPanel id="statusPanel" styleClass="ui-grid-col-3">
                    <p:outputLabel value="Status: #{detailsMB.selected.status}"/>
                    <p:commandButton value="Activeaza" update="statusPanel"
                                     actionListener="#{detailsMB.makeActive()}"
                                     rendered="#{detailsMB.selected.status eq 'EXPIRED'
                                                or detailsMB.selected.status eq 'RETIRED'}"/>
                    <p:commandButton value="Dezactiveaza" update="statusPanel"
                                     actionListener="#{detailsMB.makeRetired()}"
                                     rendered="#{detailsMB.selected.status == 'ACTIVE'}"/>
                </p:outputPanel>
            </p:outputPanel>

            <div class="ui-grid">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-12">
                        <h:outputText id="description" maxlength="150"
                                      value="#{detailsMB.selected.description}"
                                      style="width: 98%; height: 30px; resize: none"/>
                    </div>
                </div>

                <div class="ui-grid-row" style="margin-top: 10px">
                    <div class="ui-grid-col-12">
                        <p:outputLabel for="value" value="Pret: "/>
                        <h:outputText id="value" size="5" style="text-align: right"
                                      value="#{detailsMB.selected.value.value}"/>

                        <p:outputLabel for="deposit" value="Garantie: " style="margin-left: 10px"
                                       rendered="#{detailsMB.hasDeposit()}"/>
                        <h:outputText id="deposit" size="5" style="text-align: right"
                                      rendered="#{detailsMB.hasDeposit()}"
                                      value="#{detailsMB.selected.value.deposit}"/>

                        <h:outputText id="curr" size="5" style="text-align: right"
                                      value=" #{detailsMB.selected.value.currency}"/>

                        <h:outputText value=", Negociabil" rendered="#{detailsMB.selected.value.negotiable}"/>
                    </div>
                </div>

                <div class="ui-grid-row" style="margin-top: 10px">
                    <div class="ui-grid-col-12">
                        <p:outputLabel value="Adresa:"/>
                    </div>
                </div>

                <div class="ui-grid-row" style="margin-top: 10px">
                    <div class="ui-grid-col-12">
                        <h:outputText value="#{detailsMB.selected.address.city.name}"/>

                        <p:outputLabel for="street" value="Strada:" style="margin-left: 10px"/>
                        <h:outputText id="street" size="40" value="#{detailsMB.selected.address.street}"/>

                        <p:outputLabel for="nr" value="Nr.:" style="margin-left: 10px"/>
                        <h:outputText id="nr" size="2" value="#{detailsMB.selected.address.nr}"/>
                    </div>
                </div>

                <p:galleria value="#{detailsMB.selected.imageList}"
                            style="margin-top: 15px"
                            rendered="#{not empty detailsMB.selected.imageList}"
                            var="image" panelWidth="500" panelHeight="313">
                    <img src="#{image.url}" alt="Image Description for #{image.url}"/>
                </p:galleria>

                <div class="ui-grid-row" style="margin-top: 10px">
                    <div class="ui-grid-col-2">
                        <h:outputText value="Dotari:"/>
                    </div>
                    <div class="ui-grid-col-10">
                        <ul>
                            <ui:repeat value="#{detailsMB.dotari()}" var="dot">
                                <li><h:outputText value="#{dot}"/></li>
                            </ui:repeat>
                        </ul>
                    </div>
                </div>

                <div class="ui-grid-row">
                    <div class="ui-grid-col-12">
                        <p:gmap id="geoGmap" widgetVar="gMap" type="hybrid"
                                center="#{detailsMB.centerGeoMap}" zoom="11"
                                model="#{geocodeView.geoModel}"
                                style="width:100%;height:300px"/>
                    </div>
                </div>
            </div>

        </h:form>
    </ui:define>

</ui:composition>
</html>